{% extends 'base.html' %}
{% load static %}
{% block content %}
  <!-- Breadcrumb -->
  <section class="breadcrumb">
    <div class="container">
      <nav class="breadcrumb-nav">
        <a href="index.html">Home</a>
        <span class="breadcrumb-separator">></span>
        <a href="index.html#products">Products</a>
        <span class="breadcrumb-separator">></span>
        <a href="#">Accessories</a>
        <span class="breadcrumb-separator">></span>
        <span class="breadcrumb-current">Designer Handbag</span>
      </nav>
    </div>
  </section>

  <!-- Product Detail -->
  <section class="product-detail">
    <div class="container">
      <div class="product-layout">
        <!-- Product Images -->
        <div class="product-images">
          <div class="main-image">
            {% if item.image %}
            <img id="main-product-image" src="{{ item.image.url }}" alt="{{ item.name }}" />
            <div class="image-badges">
              <span class="badge sale-badge">25% OFF</span>
              <span class="badge new-badge">NEW</span>
            </div>
            {% endif %}
          </div>
           {% if item.images.all %}
          <div class="thumbnail-images">
             {% for img in item.images.all %}
            <img class="thumbnail active" src="{{ img.image.url }}" alt="Extra Image" onclick="changeMainImage(this.src)" />
            {% endfor %}
          </div>
           {% endif %}
        </div>

        <!-- Product Information -->
        <div class="product-info">
          <div class="product-meta">
            <h1 class="product-title">{{ item.name }}</h1>
            <div class="product-rating">
              <div class="stars">★★★★★</div>
              <span class="rating-text">( {{item.countReview}} Reviews)</span>
            </div>
          </div>

          <div class="product-pricing">
            <span class="current-price">$ {{ item.price }}</span>
            <span class="original-price">$399</span>
            <span class="discount-percent">25% OFF</span>
          </div>

          <div class="product-description">
            <p>{{ item.body|safe }}</p>
          </div>

          <div class="product-options">
            <div class="option-group">
              <label class="option-label">Color:</label>
              <div class="color-options">
                <button class="color-option active" style="background-color: #8B4513;" data-color="Brown"></button>
                <button class="color-option" style="background-color: #000;" data-color="Black"></button>
                <button class="color-option" style="background-color: #D2691E;" data-color="Tan"></button>
                <button class="color-option" style="background-color: #800020;" data-color="Burgundy"></button>
              </div>
              <span class="selected-option">Brown</span>
            </div>

            <div class="option-group">
              <label class="option-label">Size:</label>
              <div class="size-options">
                <button class="size-option" data-size="Small">Small</button>
                <button class="size-option active" data-size="Medium">Medium</button>
                <button class="size-option" data-size="Large">Large</button>
              </div>
            </div>
          </div>

          <div class="quantity-selector">
            <label class="option-label">Quantity:</label>
            <div class="quantity-controls">
              <button class="quantity-btn" onclick="decreaseQuantity()">-</button>
              <span class="quantity-display" id="quantity">1</span>
              <button class="quantity-btn" onclick="increaseQuantity()">+</button>
            </div>
          </div>

          <div class="product-actions">
            <button class="btn-primary add-to-cart">Add to Cart</button>
            <button class="btn-secondary wishlist-btn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
              </svg>
              Add to Wishlist
            </button>
          </div>

          <div class="product-details">
            <div class="detail-item">
              <strong>SKU:</strong> HB-2024-001
            </div>
            <div class="detail-item">
              <strong>Category:</strong> Accessories
            </div>
            <div class="detail-item">
              <strong>Material:</strong> Genuine Leather
            </div>
            <div class="detail-item">
              <strong>Dimensions:</strong> 12" x 8" x 4"
            </div>
            <div class="detail-item">
              <strong>Weight:</strong> 1.2 lbs
            </div>
          </div>

          <div class="shipping-info">
            <div class="shipping-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="1" y="3" width="15" height="13"></rect>
                <polygon points="16,6 20,6 23,11 23,16 16,16"></polygon>
                <circle cx="5.5" cy="18.5" r="2.5"></circle>
                <circle cx="18.5" cy="18.5" r="2.5"></circle>
              </svg>
              <span>Free shipping on orders over $250</span>
            </div>
            <div class="shipping-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23,4 23,10 17,10"></polyline>
                <polyline points="1,20 1,14 7,14"></polyline>
                <path d="M20.49,9A9,9,0,0,0,5.64,5.64L1,10V4H7L5.64,5.64A9,9,0,0,0,18.36,18.36L23,14v6H17Z"></path>
              </svg>
              <span>30-day return policy</span>
            </div>
            <div class="shipping-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7,11V7A5,5,0,0,1,17,7v4"></path>
              </svg>
              <span>Secure payment guaranteed</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Product Tabs -->
  <section class="product-tabs">
    <div class="container">
      <div class="tabs-header">
        <button class="tab-btn active" onclick="showTab('description')">Description</button>
        <button class="tab-btn" onclick="showTab('specifications')">Specifications</button>
        <button class="tab-btn" onclick="showTab('reviews')">Reviews (124)</button>
        <button class="tab-btn" onclick="showTab('shipping')">Shipping</button>
      </div>

      <div class="tabs-content">
        <div id="description" class="tab-content active">
          <h3>Product Description</h3>
          <p>{{ item.body|safe }}</p>

        </div>

        <div id="specifications" class="tab-content">
          <h3>Product Specifications</h3>
             {% if item.tags.exists %}
                <p class="card-text">
                    <strong>Tags:</strong>
                    {% for tag in item.tags.all %}
                        <span class="badge bg-secondary me-1">{{ tag.name }}</span>
                    {% endfor %}
                </p>
            {% endif %}
        </div>

        <div id="reviews" class="tab-content">
          <h3>Customer Reviews</h3>
          <div class="reviews-summary">
            <div class="rating-overview">
              <div class="average-rating">
                <span class="rating-number">4.8</span>
                <div class="stars">★★★★★</div>
                <span class="total-reviews">Based on 124 reviews</span>
              </div>
              <div class="rating-breakdown">
                <div class="rating-bar">
                  <span>5 stars</span>
                  <div class="bar"><div class="fill" style="width: 78%"></div></div>
                  <span>78%</span>
                </div>
                <div class="rating-bar">
                  <span>4 stars</span>
                  <div class="bar"><div class="fill" style="width: 15%"></div></div>
                  <span>15%</span>
                </div>
                <div class="rating-bar">
                  <span>3 stars</span>
                  <div class="bar"><div class="fill" style="width: 5%"></div></div>
                  <span>5%</span>
                </div>
                <div class="rating-bar">
                  <span>2 stars</span>
                  <div class="bar"><div class="fill" style="width: 1%"></div></div>
                  <span>1%</span>
                </div>
                <div class="rating-bar">
                  <span>1 star</span>
                  <div class="bar"><div class="fill" style="width: 1%"></div></div>
                  <span>1%</span>
                </div>
              </div>
            </div>
          </div>

          <div class="reviews-list">
            {% for review in reviews %}
            <div class="review-item">
              <div class="review-header">
                <div class="reviewer-info">
                <strong> {% if review.user %}
                        {{review.user.username}}
                    {% else %}
                        Anonymous User
                    {% endif %}</strong>
                  <div class="stars">★★★★★</div>
                </div>
                <span class="review-date"> {{review.updated_at}}</span>
              </div>
              <p class="review-text">{{review.subject}}</p>
              <p>{{review.review}}</p>
            </div>
            {% endfor %}

          </div>
        </div>

        <div id="shipping" class="tab-content">
          <h3>Shipping Information</h3>
          <div class="shipping-options">
            <div class="shipping-option">
              <h4>Standard Shipping (5-7 business days)</h4>
              <p>Free on orders over $250, otherwise $9.99</p>
            </div>
            <div class="shipping-option">
              <h4>Express Shipping (2-3 business days)</h4>
              <p>$19.99</p>
            </div>
            <div class="shipping-option">
              <h4>Overnight Shipping (1 business day)</h4>
              <p>$39.99</p>
            </div>
          </div>
          <div class="return-policy">
            <h4>Return Policy</h4>
            <p>We offer a 30-day return policy for all items in original condition. Returns are free and easy - just contact our customer service team to get started.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Products -->
  {% if related_items %}
  <section class="related-products">
    <div class="container">
      <h2 class="section-title">You May Also Like</h2>
      <div class="products-grid">
        {% for related in related_items %}
        <div class="product-card">
          <div class="product-image">
            {% if related.image %}
            <img src="{{ related.image.url }}" alt="{{ related.name }}" />
            {% else %}
            <div class="text-center py-5" style="background-color: #f8f9fa; position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                    No image
                </div>
            {% endif %}
            <div class="product-overlay">
                <a href="{% url 'product_detail' related.id %}"><button class="btn-secondary">Quick View</button></a>
            </div>
          </div>
          <div class="product-info">
            <h3 class="product-name">{{ related.name }}</h3>
            <p class="product-category">{{ related.category }}</p>
            <div class="product-price">
              <span class="price-current">${{ related.price }}</span>
            </div>
            <div class="product-rating">
              <div class="stars">★★★★☆</div>
              <span class="rating-count">(89)</span>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>
{% endif %}
  <!-- Footer -->
{% endblock %}